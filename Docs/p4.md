Feature work high level:

Next Feature: "The Estate Manager" (Visual Assets & Upgrades)The Goal: Turn the 2D map into a 3D board. When a user buys a "Legendary" plot, it shouldn't just be a gold square; it should be a Gold Statue or Tower that towers over the neighbors.1. The "Portfolio" Dashboard (Drill-Down View)When a user taps a parcel they already own, it shouldn't just say "Owned." It should open a "Property Performance" card (similar to checking a specific stock in Robinhood).Trust Signal: Show a "Lifetime Rent Earned" counter specific to that plot1.Visual: A mini-map snapshot of the plot.Action: "Renovate Asset" (Upgrade Button).2. The "Renovation" Mechanic (Currency Sink)This creates a use for the Zoning Permits and INK Cash.Logic: Users can upgrade a Common plot to Rare by paying a fee.Cost: 250 INK Cash + 1 Zoning Permit2.Reward: Increases Rent Multiplier (e.g., 1.0x $\to$ 1.5x) and changes the map visual.3. Map Visualization (Pseudo-3D Assets)We need to make the map look like Waze or Monopoly.Tech: Use Leaflet DivIcons with CSS 3D transforms to place "standing" buildings on the grid.Asset Classes:Common: Flat Grass / Flower Bed3.Rare: Solar Panel / Billboard (Utility)4.Epic: Brownstone House (Residential)5.Legendary: Golden Spire / Statue (Monument)6.




# TASK: Phase 4 - Property Management & 3D Assets

**Document Type:** Feature Specification
**Priority:** High
**Goal:** Implement the "Portfolio" view for owned land and render "3D" assets on the map to differentiate Rarity Tiers visually.

## 1. Feature: Map Asset Rendering ("The Board")
Turn the flat colored squares into standing structures using CSS.

### Visual Specs (Leaflet Markers)
Instead of just a colored polygon, render a `L.marker` at the center of each owned parcel with a custom `DivIcon`.
* **Common (Tier 1):** Flat texture (keep as colored grid).
* **Rare (Tier 2):** A **Solar Panel** or **Small Shop** icon standing up.
* **Epic (Tier 3):** A **Modern House** icon.
* **Legendary (Tier 4):** A **Golden Tower** or **Statue** icon.

### Technical Implementation
* **CSS 3D Effect:** Use `transform: rotateX(-45deg) translateY(-10px)` on the marker icons so they appear to "stand up" on the map, mimicking a 2.5D view.
* **Z-Index:** Ensure markers are layered correctly (southern markers above northern markers) so they overlap naturally.

## 2. Feature: The Property Dashboard (Modal)
When tapping an **OWNED** parcel, open a "Property Detail" sheet (reusing your Bottom Sheet component).

### Content Structure
1.  **Header:** Parcel ID (e.g., "PLOT-8392") & Rarity Badge.
2.  **Performance Sparkline:**
    * Show "Lifetime Rent Generated" (Track this in store or mock it: `(Date.now() - purchaseTime) * rate`).
    * Visual: A simple green line graph (SVG).
3.  **Renovation Section (Upgrade UI):**
    * **Status:** "Current Tier: Common (1.0x)".
    * **Upgrade Offer:** "Renovate to Rare (1.5x)".
    * **Cost:** "250 INK Cash + 1 Permit".
    * **Button:** "Execute Renovation" (Disabled if insufficient funds).

## 3. Step-by-Step Instructions for Cursor

1.  **Store Updates (`useGameStore.ts`):**
    * Update `ParcelData` type to include `purchaseTime` (timestamp) and `level` (1-4).
    * Add `zoningPermits` to the wallet state (if not present).
    * Add action: `upgradeParcel(id)`:
        * Checks `walletBalance >= 250` and `zoningPermits >= 1`.
        * Deducts costs.
        * Updates parcel `rarity` and `rentRate`.

2.  **Component: `AssetMarker.tsx`:**
    * Create a component that renders the specific Lucide icon (e.g., `<Home />`, `<Zap />`, `<Crown />`) based on rarity.
    * Apply the CSS transform for the "Pop-up Book" 3D look.

3.  **Component: `PropertySheet.tsx`:**
    * Build the "Stock Performance" view described above.
    * Wire the "Renovate" button to the store action.

4.  **Integration:**
    * Update `GameMap.tsx`: When looping through `ownedParcels`, render the new `AssetMarker` on top of the grid rectangle.

**Execute this plan.**