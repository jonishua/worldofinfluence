Here is the single Markdown file designed to be copied directly into Cursor (or any AI IDE). It provides the context, the specific feature requirements, and the step-by-step code instructions to build the **Interactive Supply Drop** system within your existing Next.js/Zustand stack.

```markdown
# Cursor Task: Implement Interactive "Biometric" Supply Drops

**Context:**
We are building "World of Influence," a Fintech-styled strategy game (Stack: Next.js 14, Zustand, Tailwind, Framer Motion, React-Leaflet).
We need to replace the placeholder "Tap-to-Collect" logic with a **Tactile Mini-Game**. The goal is to make finding items feel like "cracking a safe" rather than just clicking a button.

**Feature Specification: 1.2 Supply Drops (The Interactive Loot Box)**

1.  **Map Visuals:**
    * Drops are no longer simple circles. They are **3D-styled Briefcases** rendered via CSS on the map.
    * **Rarity Visuals:**
        * **Common:** Silver/Aluminum Case.
        * **Uncommon:** Matte Black Tactical Case.
        * **Rare/Legendary:** Gold-Plated Case with a pulsing aura.

2.  **Interaction Flow (The Mini-Game):**
    * **Trigger:** User taps a case on the map -> Opens a **Slide-Up Modal** (Bottom Sheet).
    * **Action:** The user sees the briefcase and a large **"Fingerprint Scanner"** button.
    * **Mechanic (Hold-to-Collect):** User must **HOLD** the button.
    * **Feedback:**
        * **Visual:** A Neon Green ring fills up around the finger. The briefcase on screen *shakes* violently as progress increases.
        * **Haptic:** Device vibration ramps up (Low buzz -> Intense vibration) as the bar fills.
    * **Success:** At 100%, the case "pops" open (Visual animation + Sound), and the Reward Screen overlays the view.

---

## Implementation Guide

Please implement the following four files/updates to achieve this functionality.

### 1. Update `tailwind.config.ts`
*Add the specific keyframes for the "Shaking" animation and the "Pop" effect.*

```typescript
// tailwind.config.ts
import type { Config } from "tailwindcss";

const config: Config = {
  // ... existing config
  theme: {
    extend: {
      keyframes: {
        'shake-intense': {
          '0%, 100%': { transform: 'translateX(0)' },
          '10%, 30%, 50%, 70%, 90%': { transform: 'translateX(-4px) rotate(-2deg)' },
          '20%, 40%, 60%, 80%': { transform: 'translateX(4px) rotate(2deg)' },
        },
        'pulse-glow': {
          '0%, 100%': { boxShadow: '0 0 10px rgba(250, 204, 21, 0.5)' },
          '50%': { boxShadow: '0 0 25px rgba(250, 204, 21, 0.8)' },
        }
      },
      animation: {
        'shake': 'shake-intense 0.5s cubic-bezier(.36,.07,.19,.97) both infinite',
        'glow': 'pulse-glow 2s infinite',
      }
    },
  },
  // ...
};
export default config;

```

### 2. Update Store Logic `store/gameStore.ts`

*Define the loot table and handling for the new "Drop" types.*

```typescript
import { create } from 'zustand';

// --- Types ---
export type DropRarity = 'Common' | 'Uncommon' | 'Rare' | 'Legendary';
export type RewardType = 'Credits' | 'INK' | 'Permit';

export interface SupplyDrop {
  id: string;
  lat: number;
  lng: number;
  rarity: DropRarity;
}

interface GameState {
  // ... existing state
  activeDrops: SupplyDrop[];
  inventory: {
    credits: number;
    inkCash: number;
    permits: number;
  };
  
  // Actions
  spawnDropsAroundUser: (lat: number, lng: number) => void;
  collectDrop: (id: string) => { type: RewardType, amount: number };
}

// --- Loot Config ---
const LOOT_TABLE = {
  Common: { chance: 0.70, type: 'Credits', min: 2, max: 5 },
  Uncommon: { chance: 0.25, type: 'INK', min: 0.01, max: 0.05 }, 
  Rare: { chance: 0.04, type: 'Credits', min: 50, max: 100 },     
  Legendary: { chance: 0.01, type: 'Permit', min: 1, max: 1 }     
};

export const useGameStore = create<GameState>((set, get) => ({
  // ... initial state
  activeDrops: [], 
  inventory: { credits: 0, inkCash: 0, permits: 0 },

  spawnDropsAroundUser: (lat, lng) => {
    // Generate 3 random drops within ~500m
    const newDrops: SupplyDrop[] = Array.from({ length: 3 }).map((_, i) => {
      const rand = Math.random();
      let rarity: DropRarity = 'Common';
      if (rand > 0.95) rarity = 'Legendary';
      else if (rand > 0.85) rarity = 'Rare';
      else if (rand > 0.60) rarity = 'Uncommon';

      return {
        id: `drop-${Date.now()}-${i}`,
        lat: lat + (Math.random() - 0.5) * 0.005, 
        lng: lng + (Math.random() - 0.5) * 0.005,
        rarity,
      };
    });
    set({ activeDrops: newDrops });
  },

  collectDrop: (id) => {
    const drops = get().activeDrops;
    const drop = drops.find(d => d.id === id);
    if (!drop) return { type: 'Credits', amount: 0 };

    const table = LOOT_TABLE[drop.rarity];
    const amount = drop.rarity === 'Legendary' ? 1 : Math.floor(Math.random() * (table.max - table.min + 1) + table.min);
    
    // Update Inventory & Remove Drop
    set((state) => ({
      activeDrops: state.activeDrops.filter(d => d.id !== id),
      inventory: {
        ...state.inventory,
        credits: table.type === 'Credits' ? state.inventory.credits + amount : state.inventory.credits,
        inkCash: table.type === 'INK' ? state.inventory.inkCash + amount : state.inventory.inkCash,
        permits: table.type === 'Permit' ? state.inventory.permits + amount : state.inventory.permits,
      }
    }));

    return { type: table.type as RewardType, amount };
  }
}));

```

### 3. Create the Mini-Game `components/SupplyDropModal.tsx`

*This component handles the "Hold to Collect" physics, haptics, and animations.*

```tsx
'use client';
import { useState, useRef, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { useGameStore, DropRarity } from '@/store/gameStore';
import { Briefcase, Fingerprint, X } from 'lucide-react'; 

const RARITY_VISUALS = {
  Common: { color: 'text-slate-400', label: 'Standard Issue', fill: 'fill-slate-200' },
  Uncommon: { color: 'text-slate-900', label: 'Tactical Case', fill: 'fill-slate-800' },
  Rare: { color: 'text-yellow-600', label: 'Bullion Transport', fill: 'fill-yellow-100' },
  Legendary: { color: 'text-yellow-400', label: 'Executive Vault', fill: 'fill-yellow-500' }
};

interface Props {
  dropId: string | null;
  onClose: () => void;
}

export default function SupplyDropModal({ dropId, onClose }: Props) {
  const { activeDrops, collectDrop } = useGameStore();
  const drop = activeDrops.find(d => d.id === dropId);
  
  const [progress, setProgress] = useState(0);
  const [isHolding, setIsHolding] = useState(false);
  const [reward, setReward] = useState<{ type: string, amount: number } | null>(null);
  const intervalRef = useRef<NodeJS.Timeout | null>(null);

  // The Gameplay Loop
  useEffect(() => {
    if (isHolding && !reward) {
      intervalRef.current = setInterval(() => {
        setProgress((prev) => {
          if (prev >= 100) {
            handleUnlock();
            return 100;
          }
          // Dynamic Haptics
          if (navigator.vibrate) {
             if (prev > 80) navigator.vibrate(40); // Intense rattle
             else if (prev % 10 === 0) navigator.vibrate(10); // Light click
          }
          return prev + 2; // Fill rate
        });
      }, 16); 
    } else {
      if (intervalRef.current) clearInterval(intervalRef.current);
      if (!reward) setProgress(0); // Reset if let go
    }
    return () => { if (intervalRef.current) clearInterval(intervalRef.current); };
  }, [isHolding, reward]);

  const handleUnlock = () => {
    if (!dropId) return;
    setIsHolding(false);
    if (navigator.vibrate) navigator.vibrate([50, 50, 200]); // Success pattern
    setReward(collectDrop(dropId));
  };

  if (!drop) return null;
  const style = RARITY_VISUALS[drop.rarity];

  return (
    <AnimatePresence>
      <motion.div 
        initial={{ y: '100%' }} animate={{ y: 0 }} exit={{ y: '100%' }}
        className="fixed bottom-0 left-0 right-0 bg-white rounded-t-3xl z-50 p-6 shadow-2xl border-t border-slate-100"
      >
        {/* Header */}
        <div className="flex justify-between mb-8">
           <div className="font-mono text-xs uppercase tracking-widest text-slate-500">
             {style.label} // {drop.rarity}
           </div>
           <button onClick={onClose}><X className="text-slate-400"/></button>
        </div>

        {/* The Briefcase (Shakes on hold) */}
        <div className="flex justify-center mb-12 relative">
          <div className={isHolding && progress < 100 ? 'animate-shake' : ''}>
            <Briefcase 
              size={120} 
              strokeWidth={1}
              className={`${style.color} ${style.fill} drop-shadow-xl`}
            />
          </div>
          
          {/* Reward Overlay */}
          {reward && (
             <motion.div 
               initial={{ scale: 0, opacity: 0 }} animate={{ scale: 1.2, opacity: 1 }}
               className="absolute inset-0 flex flex-col items-center justify-center bg-white/90 backdrop-blur-sm rounded-xl"
             >
               <div className="text-4xl font-bold text-[#00C805]">+{reward.amount}</div>
               <div className="text-sm font-bold text-slate-800">{reward.type}</div>
             </motion.div>
          )}
        </div>

        {/* Controls */}
        <div className="flex justify-center pb-8">
          {!reward ? (
            <div className="relative">
              {/* SVG Progress Ring */}
              <svg className="w-24 h-24 -rotate-90">
                <circle cx="48" cy="48" r="44" stroke="#e2e8f0" strokeWidth="4" fill="transparent"/>
                <circle 
                  cx="48" cy="48" r="44" stroke="#00C805" strokeWidth="4" fill="transparent"
                  strokeDasharray={276} strokeDashoffset={276 - (276 * progress) / 100}
                  className="transition-all duration-75 ease-linear"
                />
              </svg>
              <button
                className="absolute inset-0 flex items-center justify-center text-slate-400 active:text-[#00C805] active:scale-95 transition-all"
                onPointerDown={() => setIsHolding(true)}
                onPointerUp={() => setIsHolding(false)}
                onPointerLeave={() => setIsHolding(false)}
                onContextMenu={(e) => e.preventDefault()}
              >
                <Fingerprint size={48} />
              </button>
            </div>
          ) : (
            <button onClick={onClose} className="bg-slate-900 text-white px-8 py-3 rounded-full font-bold">
              Collect Assets
            </button>
          )}
        </div>
      </motion.div>
    </AnimatePresence>
  );
}

```

### 4. Update Map Rendering `components/GameMap.tsx`

*Use `DivIcon` to render the 3D cases on the map.*

```tsx
import { Marker } from 'react-leaflet';
import { divIcon } from 'leaflet';
import { useGameStore } from '@/store/gameStore';
import { useState } from 'react';
import SupplyDropModal from './SupplyDropModal';

// CSS-based 3D Icon generator
const createCaseIcon = (rarity: string) => {
  const styles = {
    Common: 'bg-gray-300 border-gray-400',
    Uncommon: 'bg-slate-800 border-black',
    Rare: 'bg-blue-400 border-blue-600',
    Legendary: 'bg-yellow-400 border-yellow-600 shadow-[0_0_15px_rgba(250,204,21,0.6)]'
  };
  
  return divIcon({
    className: 'bg-transparent',
    html: `
      <div class="relative w-10 h-8 hover:scale-110 transition-transform cursor-pointer">
        <div class="absolute inset-0 ${styles[rarity]} rounded-sm border-b-4 shadow-lg"></div>
        <div class="absolute -top-1 left-1/2 -translate-x-1/2 w-4 h-2 border-2 border-slate-600 rounded-t-sm"></div>
      </div>
    `,
    iconSize: [40, 32],
    iconAnchor: [20, 16]
  });
};

export default function GameMap() {
  const { activeDrops } = useGameStore();
  const [selectedDropId, setSelectedDropId] = useState<string | null>(null);

  return (
    <>
      {activeDrops.map(drop => (
        <Marker
          key={drop.id}
          position={[drop.lat, drop.lng]}
          icon={createCaseIcon(drop.rarity)}
          eventHandlers={{
            click: () => setSelectedDropId(drop.id) // Trigger Modal
          }}
        />
      ))}

      {selectedDropId && (
        <SupplyDropModal 
          dropId={selectedDropId} 
          onClose={() => setSelectedDropId(null)} 
        />
      )}
    </>
  );
}

```

```

```